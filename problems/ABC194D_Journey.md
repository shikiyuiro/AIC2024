<!--
author: HARADA Kento
-->
## [ABC194D Journey](https://atcoder.jp/contests/arc090/tasks/arc090_c)

<details><summary> ヒント1 </summary>

高橋君がいる連結成分に含まれる頂点集合を $S$、その要素数を $|S|$ とすると、$|S|$ が同じ状態はまとめて考えることができます。
</details>

<details><summary> ヒント2 </summary>

求める答えは $(|S|が1から2になるまでに行われる操作の回数の期待値)+(|S|が2から3になるまでに行われる操作の回数の期待値)+...+(|S|が n-1 から nになるまでに行われる操作の回数の期待値)$です。

</details>

<details><summary> ヒント3 </summary>

確率 $p(p \neq 0)$ で成功する試行を、成功するまで行うときの試行回数（最後の成功した回も含む）の期待値は $1/p$ です。

</details>

<details><summary> 解説 </summary>
問題で与えられたグラフのまま考えると、考えるべきグラフの状態数が膨大な数になります。そこで、状態をまとめることを考えます。

今回は、高橋君がいる連結成分に含まれる頂点集合を $S$、その要素数を $|S|$ として、$|S|$ が同じ状態をまとめて考えます。「まとめられる状態はまとめて考える」という典型テクニックです。これについては補足にも少し書きました。

すると、求める答えは  
$f(k) = (|S|がkからk+1になるまでに行われる操作の回数の期待値)$  
として
 $\sum_{k=1}^{n-1} f(k)$ となります。後は $f(k)$ が高速に求められれば良いです。

$|S|$ が $k$ から $k+1$ に遷移するのは、高橋君がまだ $|S|$ に入っていない頂点を移動先として選んだ場合です。まだ $S$ に入っていない頂点は $N-k$ 個あるため、これが起こる確率は $(N-k)/N$ です。

ここで、有名事実として「確率 $p(p \neq 0)$ で成功する試行を、成功するまで行うときの試行回数（最後の成功した回も含む）の期待値は $1/p$ である」というものがあります。証明は[公式解説](https://atcoder.jp/contests/abc194/editorial/823)を参照してください。

この事実と先程の考察を合わせると、$f(k) = N/(N-k)$ であることが分かります。この値を各 $k$ について求め、全て足し合わせればよいです。




実装例 (C++)
```cpp
#include <bits/stdc++.h>
using namespace std;

int main(){
    int n;
    cin >> n;
    double ans = 0;
    for(int i = 1;i < n;i++){
        ans += double(n)/(n-i);
    }
    cout << fixed << setprecision(7) << ans << endl;
}
```

</details>

<details><summary>補足1</summary>
状態をまとめる一般的な方法はありませんが、状態をまとめられる条件として、以下の3つを意識すると良いです。

（[DEGwerさんの数え上げテクニック集](https://degwer.hatenablog.com/entry/20171220)より引用）

- 遷移先の状態が同じである
- 遷移に付く係数が同じである
- 各状態について、そこにまとめられた状態のすべてが問題文の条件を満たすか、すべてが満たさないかのいずれかである
  

</details>

<details><summary>補足2</summary>

期待値に関する問題として、「コンプガチャ問題」も知っておくと良いです。詳しくは[こちらの記事](https://drken1215.hatenablog.com/entry/2019/03/23/214500)を参照してください。

</details>
    
