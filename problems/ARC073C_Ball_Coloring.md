<!--
author: TERAI Yoshihiko
-->
## [ARC073C Ball Coloring](https://atcoder.jp/contests/arc073/tasks/arc073_c)

<details><summary>ヒント1</summary>

一般性を失わず $x_i \leq y_i$ とします。 

$\displaystyle M := \max_{1\leq i\leq N}\{y_i\}$ とおきます。

このとき、$R_{\max} = M$ または $B_{\max} = M$ が成り立ちます。

最小値 $m$ についても同様の性質が成り立ちます。
</details>

<details><summary>ヒント2</summary>

対称性から、$R_{\max} = M$ として一般性を失いません。
以下の $2$ つの場合についてそれぞれ考えてみましょう。

1. $R_{\min} = m$ の場合
2. $B_{\min} = m$ の場合
</details>
    
<details><summary>ヒント3</summary>

最小値と最大値の差を最小化する問題は、<b>最小値を決め打って最大値を最小化する</b>という方法が筋が良いです。
</details>

<details><summary>解説</summary>

ヒント 2 のそれぞれの場合について解きます。

#### $R_{\min} = m$ の場合

$R_{\max} - R_{\min}$ が $M - m$ で固定されます。したがって青く塗るボールを工夫して $B_{\max} - B_{\min}$ を最小化する問題に帰着されます。

最大値と最小値の差を最小化する問題は、最小値を固定して最大値を最小化するという手法が筋が良いことが多いです。今回の問題もその発想で解くことができます。

1. 最初、すべての箱について $x_i$ が書かれたボールを青く、$y_i$ が書かれたボールを赤く塗る。（ただし $R_{\min}$ に関わるボールについてはこの限りでない）
2. 青く塗られたボールのうち最も値の小さいものを赤く、同じ箱に入っている赤いボールを青く塗る、という処理を繰り返す。

この処理の途中で現れた塗り分け方のうち、$B_{\max} - B_{\min}$ が最も小さいものが答えです。この処理は例えば Segment Tree などを用いて $\mathrm{O}(N\log N)$ 時間で行えます。

#### $B_{\min} = m$ の場合

各箱について、$y_i$ が書かれたボールを赤く、$x_i$ が書かれたボールを青く塗るだけでよいです。逆に塗ったとしても、明らかに解が改善しないからです。これは $\mathrm{O}(N)$ 時間で行えます。

</details>

<details><summary>簡単な補足</summary>

今回の問題では塗り方の場合の数が $2^N$ 個存在し、これをすべて探索するのは絶望的です。このような問題では、「コストやスコアの特殊性から探索範囲を絞る」ことが重要です。

- 定数個の候補しかないことを示し、それらをすべて試す（|| https://atcoder.jp/contests/arc158/tasks/arc158_b || など）
- $\mathrm{o}(N^2)$ 個の候補（例えば $\mathrm{O}(N)$ や $\mathrm{O}(N\log N)$ など）を、差分を高速に求めることですべて試す（今回の問題）

というアプローチの問題はよく見ます。今回の問題は求める値に「それぞれの色の最大値/最小値」しか寄与しないことが探索範囲を絞る肝になっています。
</details>
