<!--
author: HARADA Kento
-->
## [ABC094D Binomial Coefficients](https://atcoder.jp/contests/abc094/tasks/arc095_b)

<details><summary> ヒント1 </summary>

$a_i$ の最大値が $10^9$ なので、二項係数の値を計算して大小を比較することは出来そうにありません。具体的な計算せずに大小比較する方法を考えましょう。

</details>

<details><summary> ヒント2 </summary>

$\mathrm{comb}(n,r)$ には $n$ と $r$という二つの変数があります。このように、変数が複数ある場合はある一つ以外を固定して一変数にすると考えやすくなります。

</details>

<details><summary> ヒント3 </summary>

$n$を固定するとき $r$としてどのような値を選べば $\mathrm{comb}(n,r)$ が最も大きくなるでしょうか。
また、$r$を固定するとき $n$としてどのような値を選べば $\mathrm{comb}(n,r)$ が最も大きくなるでしょうか。  

</details>

<details><summary> 解説 </summary>

$a_i$の最大値が $10^9$ と非常に大きいので、二項係数の値を計算して大小を比較することは出来そうにありません。具体的な値を計算せずに大小比較する方法を考えます。

$\mathrm{comb}(n,r)$ には $n$ と $r$という二つの変数があり、このままでは考えづらいです。そこで、片方を固定するとき、もう片方の変数としてどのような値を選べば二項係数の値が最大になるか考えます。これは、「一変数にして考える」という典型テクニックです。

さて、$n$を固定するとき $r$としてどのような値を選べば $\mathrm{comb}(n,r)$ が最も大きくなるでしょうか。 結論から述べると、なるべく $n/2$ に近い値を $r$ に選ぶと $\mathrm{comb}(n,r)$ が最も大きくなります。直感的には、パスカルの三角形において、より中心にある値の方が大きくなることから理解できます。また、確率統計の授業を受けたことがある方は、二項分布の形を思い出すと分かりやすいと思います。厳密な証明は公式解説を参照してください。  

コンテスト中にこれを思いつかけなくても、$n$、$r$ が小さい範囲で $\mathrm{comb}(n,r)$ を出力するプログラムを書いて出力を眺めれば気づくことができます。また、「$n$を固定するとき $r$としてどのような値を選べば $\mathrm{comb}(n,r)$ が最も大きくなりますか？」とChatGPTに聞くと正しい答えが返ってきます。  

続いて、$r$ を固定するとき $n$ としてどのような値を選べば $\mathrm{comb}(n,r)$ が最も大きくなるでしょうか。この場合は、なるべく大きな値を $n$ に選べばよいです。$\mathrm{comb}(n,r)$ は「$n$ 個のボールの中から $r$ 個のボールを選ぶ場合の数」を表しているので、ボールの数が増えるほど場合の数が増えると考えれば直感的に理解できます。こちらについても、厳密な証明は公式解説を参照してください。

以上の事実から、$\mathrm{max}(a_i)$ を $n$ に、$\mathrm{max}(a_i)/2$ に最も近い値を $r$ に選べばよいことが分かります。計算量は $\mathrm{O}(N)$ です。

[実装例(C++)](https://atcoder.jp/contests/abc094/submissions/53758964)
    

</details>
