<!--
author: ISHIKAWA Yuichiro
-->
## [AGC028B Removing Blocks](https://atcoder.jp/contests/agc028/tasks/agc028_b)

<details><summary> ヒント1 </summary>

答えは線形性を持ちます。
すなわち、
ケース
```
3
1 2 3
```
の答えは、  
以下の3つのケース
```
3
1 0 0
```
```
3
0 2 0
```
```
3
0 0 3
```
の答えの和に等しくなります。  
<b>特に、各ブロックのコストへの寄与は独立です。</b>

</details>

<details><summary> ヒント2 </summary>

ケース
```
5
0 0 0 1 0
```
において、左から $2$ 番目のブロックを取り除いた時にコスト $1$ がかかるような取り除き方は、すべての( $5!$ 通りの)取り除き方のうち、ちょうど $1/3$ ($5!/3$通り)に等しいです。この性質はどのように示されるでしょうか?また一般的にどのように主張できるでしょうか?
</details>

<details><summary> 解説 </summary>

ヒント2で挙げられた性質について説明します。
ケース
```
5
0 0 0 1 0
```
において、左から $2$ 番目のブロックを取り除いた時にコスト $1$ がかかるような取り除き方は、左から $2$ 番目 ~ $4$ 番目までのブロックのなかで、左から $2$ 番目のブロックを取り除くのがもっとも早いような取り除き方とみなすことができます。したがって、そのような取り除き方は取り除き方全体のうち、ちょうど $1/3$ です。  
より一般的に、左から $i$ 番目のブロックを取り除くときに、左から $j$ 番目のブロックのコストがかかるような取り除き方は、ちょうど $\frac{N!}{abs(i - j) + 1}$ 通りに等しいです。  

したがって、左から $j$ 番目のブロックのコストの寄与は  
$A_j * N! * (\frac{1}{abs(1 - j) + 1} + \frac{1}{abs(2 - j) + 1} + ... + \frac{1}{abs(N - j) + 1})$  
であり、これを $j = 1, 2, ..., N$ について足し合わせればよいです。  
逆数和の部分は然るべき累積和で高速化でき、時間計算量は $\mathrm{O}(N)$です。

</details>
