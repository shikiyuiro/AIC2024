<!--
author: ISHIKAWA Yuichiro
-->
## [ARC115C N coloring](https://atcoder.jp/contests/arc125/tasks/arc115_c)

<details><summary> ヒント </summary>

例として、$N = 50$ のもと、$A_{36}$としてありうる最小値を考えます。

$1$は$2$を、$2$は$4$を、$4$は$12$を、$12$は$36$をそれぞれ割り切ることに着目すると、

$1 \leq A_{1} \lt A_{2} \lt A_{4} \lt A_{12} \lt A_{36}$

が成り立ちます。このことから、$A_{36}$としてありうる値は少なくとも$5$以上だとわかります。  
(よくあるテクニック: ナイスな<b>下界</b>を考える)

上の手法を<b>素因数分解</b>に注意して一般化してみましょう。  
(たとえば $36 = 2^2 * 3^2 * 5^0 * ...$)

</details>

<details><summary> 解説 </summary>

$i = 2^{d_2} * 3^{d_3} * 5^{d_5} * 7^{d_7} * ...$ と素因数分解し、  
$A_{i} = 1 + d_2 + d_3 + d_5 + d_7 + ...$ と定めればよいです。

($A_{i}$が条件を満たすこと)  
$i = 2^{d_2} * 3^{d_3} * 5^{d_5} * 7^{d_7} * ...$  
$j= 2^{e_2} * 3^{e_3} * 5^{e_5} * 7^{e_7} * ...$  
と表される $i$, $j$ について、
$i$ が $j$ を割り切るとき、 $d_2 \lt e_2, \, d_3 \lt e_3, ...$ が成り立つことから、  
$d_2 + d_3 + ... < e_2 + e_3 + ...$ より、
$A_{i} < A_{j}$ がしたがいます。

($A_{i}$が最小であること)  
例えば
$36 = 2^{2} * 3^{2}$  
について、倍数関係の昇鎖列
$2^0*3^0 → 2^1*3^0 →2^2*3^0→2^2*3^1→2^2*3^2$ が構成できます。  
より一般的に $1$ から $i = 2^{d_2} * 3^{d_3} * 5^{d_5} * 7^{d_7} * ...$  
に到達するまでの $1 + d_2 + d_3 + ...$ 個の整数からなる倍数関係の昇鎖列が構成できるため、$1 + d_2 + d_3 + ... + \leq A_{i}$ が成立します。

以上より、上の定め方が解を与えることがわかりました。  
このような$A_{i}$を具体的に求める方法として、ポラード・ロー法による各整数ごとの素因数分解や、ユークリッドの互除法の上で解く方法、線形篩などで最小素因数を求め、dpをする方法などが挙げられます。

時間計算量は線形篩＋DPによる解法なら$\mathrm{O}(N)$、その他の解法でも十分高速です。

</details>
